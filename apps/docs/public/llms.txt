# Cloudwerk

> A full-stack framework for Cloudflare Workers with file-based routing that compiles to Hono.

Cloudwerk brings the developer experience of modern frameworks like Next.js to Cloudflare Workers. Write intuitive file-based routes, use familiar patterns for data loading, and deploy globally in seconds.

## Status

Pre-alpha - APIs are unstable.

## Key Features

- File-based routing (pages, layouts, API routes)
- Server-side rendering with streaming support
- Data loading with loader() functions
- First-class Cloudflare integration (D1, KV, R2, Queues, Durable Objects)
- TypeScript-first
- Compiles to Hono

## Quick Start

```bash
pnpm create cloudwerk@latest my-app
cd my-app
pnpm dev
```

## Core Concepts

### Pages
Create `app/page.tsx` files for routes. Export a default component and optional `loader()` for data fetching.

### API Routes
Create `app/api/*/route.ts` files. Export HTTP method handlers (GET, POST, PUT, DELETE, etc.).

### Layouts
Create `app/layout.tsx` files to wrap pages with shared UI.

### Middleware
Create `app/middleware.ts` files to intercept requests.

## Documentation

- Website: https://cloudwerk.dev
- Full docs: https://cloudwerk.dev/llms-full.txt
- GitHub: https://github.com/squirrelsoft-dev/cloudwerk

## File Conventions

| File | Purpose |
|------|---------|
| page.tsx | Page component |
| route.ts | API endpoint |
| layout.tsx | Layout wrapper |
| middleware.ts | Request middleware |
| error.tsx | Error boundary |
| not-found.tsx | 404 handler |

## Cloudflare Bindings

Access via `context` in loaders and handlers:

- `context.db` - D1 database
- `context.kv` - KV namespace
- `context.r2` - R2 bucket
- `context.queues` - Queue producers
- `context.env` - Environment variables

## Example Page

```tsx
import type { PageProps, LoaderArgs } from '@cloudwerk/core';

export async function loader({ params, context }: LoaderArgs) {
  const user = await context.db
    .selectFrom('users')
    .where('id', '=', params.id)
    .executeTakeFirst();
  return { user };
}

export default function UserPage({ user }: PageProps & { user: User }) {
  return <h1>{user.name}</h1>;
}
```

## Example API Route

```typescript
import { json } from '@cloudwerk/core';

export async function GET(request: Request, { context }) {
  const users = await context.db.selectFrom('users').execute();
  return json(users);
}

export async function POST(request: Request, { context }) {
  const body = await request.json();
  const user = await context.db.insertInto('users').values(body).execute();
  return json(user, { status: 201 });
}
```
